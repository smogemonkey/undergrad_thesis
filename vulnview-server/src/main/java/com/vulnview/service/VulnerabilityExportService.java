package com.vulnview.service;

import com.vulnview.enums.ExportFormat;
import java.util.List;
import java.util.Map;

public interface VulnerabilityExportService {
    /**
     * Generate an Excel report for vulnerabilities in a repository
     * @param repositoryId The ID of the repository
     * @return Excel file as byte array
     */
    byte[] generateExcelReport(Long repositoryId);

    /**
     * Compare vulnerabilities between two versions
     * @param repositoryId The ID of the repository
     * @param baselineVersion The baseline version to compare against
     * @param currentVersion The current version to compare
     * @return Map containing comparison results
     */
    Map<String, Object> compareVulnerabilities(Long repositoryId, String baselineVersion, String currentVersion);

    /**
     * Get vulnerability history for a repository
     * @param repositoryId The ID of the repository
     * @return List of vulnerability history entries
     */
    List<Map<String, Object>> getVulnerabilityHistory(Long repositoryId);

    /**
     * Export vulnerabilities in the specified format
     * @param projectId The ID of the project
     * @param format The export format (PDF, CSV, or JSON)
     * @return Exported file as byte array
     */
    byte[] exportVulnerabilities(Long projectId, ExportFormat format);
} 